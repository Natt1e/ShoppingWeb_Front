{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport Mybutton from '@/components/Mybutton.vue';\nexport default {\n  name: \"Detail\",\n  components: {\n    Mybutton\n  },\n\n  async created() {\n    this.id = this.$route.query.id;\n    await axios.get('/api/getcart/' + this.id + '/').then(res => {\n      this.goods = res.data;\n    });\n\n    for (var i = 0; i < this.goods.length; i++) {\n      await this.$axios({\n        method: 'post',\n        url: '/api/gooddetail/',\n        data: JSON.stringify({\n          user: this.id,\n          good: this.goods[i].id\n        })\n      }).then(res => {\n        this.goodDetail.push(res.data);\n      });\n    }\n  },\n\n  data() {\n    return {\n      id: '',\n      goods: [],\n      visible: false,\n      pic: '1.jpg',\n      goodDetail: [],\n      count: []\n    };\n  },\n\n  computed: {\n    total: function () {\n      let result = 0;\n\n      for (var i = 0; i < this.goods.length; i++) {\n        result = result + this.goodDetail[i].price;\n      }\n\n      return result;\n    }\n  },\n  methods: {\n    img(good) {\n      return good.pic;\n    },\n\n    addCount(index) {\n      this.goods[index].count = this.goods[index].count + 1;\n      this.$axios({\n        method: 'post',\n        url: '/api/changecart/',\n        data: JSON.stringify({\n          buyer: this.id,\n          good: this.goods[index].id,\n          count: this.goods[index].count\n        })\n      }).then(res => {});\n    },\n\n    minCount(index) {\n      if (this.goods[index].count > 1) {\n        this.goods[index].count = this.goods[index].count - 1;\n        this.$axios({\n          method: 'post',\n          url: '/api/changecart/',\n          data: JSON.stringify({\n            buyer: this.id,\n            good: this.goods[index].id,\n            count: this.goods[index].count\n          })\n        }).then(res => {});\n      }\n    },\n\n    del(index) {\n      this.$axios({\n        method: 'delete',\n        url: '/api/deletecartgood/' + this.id + '/' + this.goods[index].goodId + '/'\n      }).then(res => {\n        this.$router.go(0);\n      });\n    },\n\n    buyAll() {\n      this.visible = false;\n      this.$axios({\n        method: 'post',\n        url: '/api/clearcart/',\n        data: JSON.stringify({\n          buyerId: this.id,\n          place: \"北京\"\n        })\n      }).then(res => {\n        if (res.data == -1) {\n          alert('老板的钱有点不够');\n        } else if (res.data == -2) {\n          alert('老板,商品余量不足~');\n        } else {\n          alert('老板大气！欢迎下次光临');\n          this.$router.go(0);\n        }\n      });\n      this.$router.go(0);\n    },\n\n    back() {\n      this.$router.push({\n        path: '/main',\n        query: {\n          userId: this.id\n        }\n      });\n    }\n\n  },\n  filters: {\n    numFilter(value) {\n      let real = parseFloat(value).toFixed(2);\n      return real;\n    }\n\n  }\n};","map":{"version":3,"mappings":";AAgFA;AACA;AACA;EACAA,cADA;EAEAC;IACAC;EADA,CAFA;;EAKA;IACA;IACA;MACA;IACA,CAFA;;IAIA;MACA;QACAC,cADA;QAEAC,uBAFA;QAGAC;UACAC,aADA;UAEAC;QAFA;MAHA,GAOAC,IAPA,CAOAC;QACA;MACA,CATA;IAUA;EACA,CAvBA;;EAwBAJ;IACA;MACAK,MADA;MAEAC,SAFA;MAGAC,cAHA;MAIAC,YAJA;MAKAC,cALA;MAMAC;IANA;EAQA,CAjCA;;EAkCAC;IACAC;MACA;;MACA;QACAC;MACA;;MACA;IACA;EAPA,CAlCA;EA2CAC;IACAC;MACA;IACA,CAHA;;IAIAC;MACA;MACA;QACAlB,cADA;QAEAC,uBAFA;QAGAC;UACAiB,cADA;UAEAf,0BAFA;UAGAQ;QAHA;MAHA,GAQAP,IARA,CAQAC,QACA,CATA;IAUA,CAhBA;;IAiBAc;MACA;QACA;QACA;UACApB,cADA;UAEAC,uBAFA;UAGAC;YACAiB,cADA;YAEAf,0BAFA;YAGAQ;UAHA;QAHA,GAQAP,IARA,CAQAC,QACA,CATA;MAUA;IACA,CA/BA;;IAgCAe;MACA;QACArB,gBADA;QAEAC;MAFA,GAGAI,IAHA,CAGAC;QACA;MACA,CALA;IAMA,CAvCA;;IAwCAgB;MACA;MACA;QACAtB,cADA;QAEAC,sBAFA;QAGAC;UACAqB,gBADA;UAEAC;QAFA;MAHA,GAOAnB,IAPA,CAOAC;QACA;UACAmB;QACA,CAFA,MAEA;UACAA;QACA,CAFA,MAEA;UACAA;UACA;QACA;MACA,CAhBA;MAiBA;IACA,CA5DA;;IA6DAC;MACA;QAAAC;QAAAC;UAAAC;QAAA;MAAA;IACA;;EA/DA,CA3CA;EA4GAC;IACAC;MACA;MACA;IACA;;EAJA;AA5GA","names":["name","components","Mybutton","method","url","data","user","good","then","res","id","goods","visible","pic","goodDetail","count","computed","total","result","methods","img","addCount","buyer","minCount","del","buyAll","buyerId","place","alert","back","path","query","userId","filters","numFilter"],"sourceRoot":"src/views","sources":["ShoppingCart.vue"],"sourcesContent":["<template>\n<div>\n    <div class=\"center\">\n        <span @click=\"back\">\n        <div style=\"display: inline-block;\">\n            <img src=\"../assets/logo.png\" width=\"80\">\n        </div>\n        <div class=\"logo\" style=\"text-align:center;display: inline-block;\">\n            <div>烧瓶</div>\n            <div style=\"font-size: 16px;\">心仪生活上烧瓶</div>\n        </div>\n        </span>\n        <div class=\"logo\">\n            购物车\n        </div>\n        <el-popover placement=\"top\" width=\"160\" v-model=\"visible\">\n                <p>确定要清空购物车吗</p>\n            <div style=\"text-align: right; margin: 0\">\n                <el-button size=\"mini\" type=\"text\" @click=\"visible = false\">取消</el-button>\n                <el-button type=\"primary\" size=\"mini\" @click=\"buyAll\">确定</el-button>\n            </div>\n              <el-button plain slot=\"reference\" type=\"primary\" \n              style=\"height: 37px;font-size:16px;background-color: rgb(174, 0, 255);color: white;\">结算</el-button>\n        </el-popover>\n        合计： {{ total }}\n    </div>\n\n    <div id = \"main\">\n        <!-- <div v-if=\"goods.length==0\" id=\"no\">\n            <el-empty image-size:50px description=\"这里什么都没有呢，快去逛逛叭~\" style=\"position:absolute;margin-left:25%;margin-top:5%;\"></el-empty>\n        </div> -->\n        <!-- <div>\n            <div style=\"height: 30px;font-size: 20px;\">\n                    <div style=\"display:inline-block;position: absolute;left: 600px\">名称</div>\n                    <div style=\"display:inline-block;position: absolute;left: 820px;\">单价</div>\n                    <div style=\"display:inline-block;position: absolute;left: 980px;\">数量</div>\n                    <div style=\"display:inline-block;position: absolute;left: 1140px;\">总价</div>\n            </div>\n            <div  id=\"cart\" v-for=\"(value,index) in goods\">\n                <div class=\"block\" id=\"pic\"><img :src=\"img(value)\" width=\"80\" height=\"80\"></div>\n                <div class=\"block\" id=\"des\">\n                    <div id=\"txt\">\n                        {{des[index]}}\n                    </div>                \n                </div>\n                <div class=\"block\" id=\"price\">￥{{price[index]|numFilter}}</div>\n                <div class=\"block\" id=\"numberCount\" @click=\"change_count(index)\"><el-input-number style=\"size:20px;\" v-model=\"count[index]\" ></el-input-number></div>\n                <div class=\"block\" id=\"count\">￥{{price[index]*count[index]|numFilter}}</div>\n                <div class=\"block\" id=\"op\"><el-button @click=\"del(index)\">删除</el-button></div>\n            </div>\n        </div>     -->\n        <div class=\"item\" v-for=\"(value,index) in goodDetail\">\n            <div class=\"imageBox\"\n            :style=\"{'backgroundImage': 'url(' + require('../../../static/' + value.pic[0])  + ')'}\">\n            </div>\n            <div class=\"nameText\">\n                {{ value.description }}\n            </div>\n            <div class=\"priceBox\">\n                <div style=\"padding-top:80%\">\n                    ￥{{ value.price }}\n                </div>\n            </div>\n            <div class=\"counter\">\n                <div>\n                    <i class=\"el-icon-plus\" style=\"margin-right:5%\" @click=\"addCount(index)\"></i>\n                        {{goods[index].count}}\n                    <i class=\"el-icon-minus\" style=\"margin-left:5%\" @click=\"minCount(index)\"></i>\n                </div>\n                <div class=\"money\">\n                    ￥{{ goods[index].count * value.price }}\n                </div>\n            </div>\n        </div>\n    </div>\n\n</div>\n</template>\n\n<script>\n    import axios from 'axios';\n    import Mybutton from '@/components/Mybutton.vue';\n    export default {\n        name: \"Detail\",\n        components: {\n            Mybutton\n        },\n        async created() {\n            this.id=this.$route.query.id;\n            await axios.get('/api/getcart/' + this.id + '/').then((res) => {\n                this.goods = res.data;           \n            })\n            \n            for(var i=0;i<this.goods.length;i++) {\n                await this.$axios({\n                    method: 'post',\n                    url: '/api/gooddetail/',\n                    data: JSON.stringify({\n                            user: this.id,\n                            good:this.goods[i].id\n                            })\n                    }).then((res) => {\n                        this.goodDetail.push(res.data);\n                    });\n                }            \n        },\n        data() {\n            return {\n                id: '',\n                goods: [],\n                visible: false,\n                pic: '1.jpg',\n                goodDetail: [],\n                count : []\n            }\n        },\n        computed: {\n            total: function() {\n                let result = 0;\n                for (var i=0;i<this.goods.length;i++) {\n                    result = result + this.goodDetail[i].price;\n                }\n                return result;\n            }\n        },\n        methods: {\n            img(good) {\n                return good.pic;\n            },\n            addCount(index) {\n                this.goods[index].count = this.goods[index].count + 1;\n                this.$axios({\n                    method: 'post',\n                    url: '/api/changecart/',\n                    data: JSON.stringify({\n                                buyer: this.id,\n                                good: this.goods[index].id,\n                                count: this.goods[index].count\n                        })\n                }).then(res => {\n                });\n            },\n            minCount(index) {\n                if (this.goods[index].count > 1) {\n                    this.goods[index].count = this.goods[index].count - 1;\n                    this.$axios({\n                    method: 'post',\n                    url: '/api/changecart/',\n                    data: JSON.stringify({\n                                buyer: this.id,\n                                good: this.goods[index].id,\n                                count: this.goods[index].count\n                    })\n                    }).then(res => {\n                    });\n                }\n            },\n            del(index) {\n                this.$axios({\n                    method: 'delete',\n                    url: '/api/deletecartgood/' + this.id + '/' + this.goods[index].goodId + '/',\n                }).then(res => {\n                    this.$router.go(0);\n                })\n            },\n            buyAll() {\n                this.visible = false;\n                this.$axios({\n                    method: 'post',\n                    url: '/api/clearcart/',\n                    data: JSON.stringify({\n                                buyerId: this.id,\n                                place: \"北京\"\n                        })\n                }).then(res => {\n                    if (res.data == -1) {\n                        alert('老板的钱有点不够');\n                    } else if (res.data == -2) {\n                        alert('老板,商品余量不足~');\n                    } else {\n                        alert('老板大气！欢迎下次光临');\n                        this.$router.go(0);\n                    }     \n                })\n                this.$router.go(0);\n            },\n            back() {\n                this.$router.push({path:'/main',query: {userId: this.id} });     \n            }\n        },\n        filters:{\n                numFilter (value) {\n                    let real = parseFloat(value).toFixed(2);\n                    return real;\n                }\n            }\n    }\n</script>\n\n<style scope>\n    .item {\n        position: relative;\n        text-align: left;\n        width: 80%;\n        height: auto;\n        margin: auto;\n        border-style: solid;\n        border-color: rgba(149, 157, 159, 0.58);\n        background-color: aliceblue;\n        margin-top: 3%;\n    }\n    .imageBox::after {\n        content: \"\";\n        padding-bottom: 100%;\n        display: block;\n    }\n    .imageBox {\n      display: inline-block;\n      width:15%;\n      background: no-repeat; \n      -webkit-background-size: 100%;\n      -moz-background-size: 100%;\n      -o-background-size: 100%;\n      background-size: 100%;\n    }\n    .nameText {\n        display: inline-block;\n        vertical-align: top;\n        font-size: 18px;\n        font-weight: 700;\n        height: auto;\n        width: 50%;\n        overflow: hidden;\n    }\n    .priceBox {\n        margin-left: 3%;\n        padding-right: 3%;\n        display: inline-block;\n        font-size: 20px;\n        border-right: solid;\n        border-color: rgb(201, 200, 199) ;\n        border-width: 1px;\n        font-weight: 900;\n        position: absolute;\n        vertical-align: bottom;\n        height: 100%;\n    }\n    .counter {\n        position: absolute;\n        display: inline-block;\n        right: 0;\n    }\n    .money {\n        margin-top: 20%;\n        font-size: 25px;\n        font-weight: 1000;\n    }\n        .logo {\n            display: inline-block;\n            color: rgb(174, 0, 255);\n            font-size: 30px;\n            font-weight: 600;\n            margin-right: 40px;\n        }\n        .center {\n            margin-top: 10px;\n            text-align: center;\n            margin-bottom: 10px;\n        }\n    #main{\n            height: 100%;\n            width: 75%;\n            background-color: rgb(207, 202, 202);\n            position: absolute;\n            margin-left: 15%;\n            margin-top: 1%;\n            border-radius: 50px;\n        }\n    .block{\n        display: inline-block;\n    }\n    #cart{\n        background-color: white;\n        width: 70%;\n        height: 90px;\n        padding-top: 1%;\n        padding-left: 1%;\n        position: relative;\n    }\n    #des{\n        position: absolute; top:20px;\n        margin-right: 20px;\n        width: 200px;\n    }\n    #txt{\n        font-size: 13px;\n        text-align: left;\n        display: -webkit-box;\n        -webkit-box-orient: vertical;\n        -webkit-line-clamp: 2;\n        overflow: hidden;\n        text-overflow: ellipsis;\n    }\n    #price{\n        position: absolute; top:20px;left:350px;\n    }\n    #numberCount{\n        position: absolute; top:20px;left:450px;\n    }\n    #count{\n        position: absolute; top:20px;left:650px;\n    }\n    #op{\n        position: absolute; top:20px;left:800px;\n    }\n    button:hover {\n            background-color: cornflowerblue;\n    }\n    #no {\n        margin-left: -120px;\n    }\n</style>"]},"metadata":{},"sourceType":"module"}